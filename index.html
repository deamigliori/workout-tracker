<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Desafio de Ginástica</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: Arial, sans-serif;
        }

        body {
            padding: 1rem;
            background-color: #f5f5f5;
        }

        .container {
            max-width: 100%;
            margin: 0 auto;
            background-color: white;
            padding: 1rem;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .title {
            text-align: center;
            margin-bottom: 1rem;
            color: #333;
        }

        .participants {
            display: grid;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        @media (min-width: 768px) {
            .participants {
                grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            }
        }

        .participant-card {
            padding: 1rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            transition: background-color 0.3s;
        }

        .participant-card.leader {
            background-color: #e6ffe6;
            border-color: #4CAF50;
        }

        .activity-input {
            display: flex;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }

        input[type="date"] {
            padding: 0.5rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            flex: 1;
        }

        button {
            padding: 0.5rem 1rem;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        button:hover {
            background-color: #45a049;
        }

        .stats {
            margin-top: 0.5rem;
            font-size: 0.9rem;
        }

        .negative {
            color: #f44336;
        }

        .positive {
            color: #4CAF50;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="title">Desafio de Ginástica</h1>
        <div class="participants" id="participants"></div>
    </div>

    <script>
        const startDate = new Date('2025-01-06');
        const endDate = new Date('2025-07-31');
        const participantNames = ['Participante 1', 'Participante 2', 'Participante 3', 'Participante 4', 'Participante 5'];
        const ACTIVITY_VALUE = 10; // euros

        let participants = loadParticipants() || initializeParticipants();

        function initializeParticipants() {
            return participantNames.map(name => ({
                name,
                activities: [],
                balance: calculateInitialBalance()
            }));
        }

        function calculateInitialBalance() {
            let weeks = 0;
            let currentDate = new Date(startDate);
            while (currentDate <= endDate) {
                weeks++;
                currentDate.setDate(currentDate.getDate() + 7);
            }
            return -(weeks * 3 * ACTIVITY_VALUE); // 3 activities per week
        }

        function loadParticipants() {
            const saved = localStorage.getItem('fitnessChallenge');
            if (saved) {
                const parsed = JSON.parse(saved);
                parsed.forEach(p => {
                    p.activities = p.activities.map(a => new Date(a));
                });
                return parsed;
            }
            return null;
        }

        function saveParticipants() {
            localStorage.setItem('fitnessChallenge', JSON.stringify(participants));
        }

        function addActivity(participantIndex, date) {
            const participant = participants[participantIndex];
            if (!participant.activities.some(a => a.toDateString() === date.toDateString())) {
                participant.activities.push(date);
                participant.balance += ACTIVITY_VALUE;
                saveParticipants();
                renderParticipants();
            } else {
                alert('Atividade já registrada para esta data!');
            }
        }

        function getLeaderIndex() {
            return participants.reduce((maxIndex, current, index, array) => 
                current.activities.length > array[maxIndex].activities.length ? index : maxIndex
            , 0);
        }

        function renderParticipants() {
            const container = document.getElementById('participants');
            container.innerHTML = '';
            const leaderIndex = getLeaderIndex();

            participants.forEach((participant, index) => {
                const card = document.createElement('div');
                card.className = `participant-card ${index === leaderIndex ? 'leader' : ''}`;
                
                card.innerHTML = `
                    <h2>${participant.name}</h2>
                    <div class="stats">
                        <p>Atividades realizadas: ${participant.activities.length}</p>
                        <p>Saldo: <span class="${participant.balance >= 0 ? 'positive' : 'negative'}">€${participant.balance}</span></p>
                    </div>
                    <div class="activity-input">
                        <input type="date" 
                            min="${startDate.toISOString().split('T')[0]}"
                            max="${endDate.toISOString().split('T')[0]}"
                        >
                        <button onclick="handleAddActivity(${index}, this)">Registrar</button>
                    </div>
                `;

                container.appendChild(card);
            });
        }

        function handleAddActivity(index, button) {
            const dateInput = button.parentElement.querySelector('input[type="date"]');
            if (dateInput.value) {
                const date = new Date(dateInput.value);
                if (date >= startDate && date <= endDate) {
                    addActivity(index, date);
                    dateInput.value = '';
                } else {
                    alert('Data fora do período do desafio!');
                }
            } else {
                alert('Selecione uma data!');
            }
        }

        // Inicialização
        renderParticipants();
    </script>
</body>
</html>
