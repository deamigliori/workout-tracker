<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <style>
        .container {
            max-width: 100%;
            overflow-x: auto;
            font-family: Arial, sans-serif;
            padding: 20px;
        }
        
        table {
            border-collapse: collapse;
            width: 100%;
            margin-bottom: 20px;
        }
        
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: center;
        }
        
        th {
            background-color: #f5f5f5;
            font-weight: bold;
        }
        
        input[type="number"] {
            width: 50px;
            padding: 5px;
            text-align: center;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        
        .leader {
            background-color: #e8f5e9;
        }
        
        .last-place {
            background-color: #ffebee;
        }
        
        .info-box {
            background-color: #f5f5f5;
            padding: 15px;
            border-radius: 4px;
            margin-top: 20px;
        }
        
        .progress-bar-container {
            width: 100%;
            background-color: #f0f0f0;
            border-radius: 10px;
            margin: 5px 0;
        }
        
        .progress-bar {
            height: 20px;
            border-radius: 10px;
            transition: width 0.5s ease-in-out;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 5px;
            color: white;
            font-size: 12px;
        }
        
        .progress-level-1 { background-color: #9e9e9e; }
        .progress-level-2 { background-color: #9c27b0; }
        .progress-level-3 { background-color: #2196f3; }
        .progress-level-4 { background-color: #4caf50; }
    </style>
</head>
<body>
    <div class="container">
        <h1 style="text-align: center;">Controle do Desafio de Ginástica</h1>
        
        <table id="workoutTable">
            <thead>
                <tr>
                    <th>Participante</th>
                    <th>Semana 1<br>06/01 - 12/01</th>
                    <th>Semana 2<br>13/01 - 19/01</th>
                    <th>Semana 3<br>20/01 - 26/01</th>
                    <th>Total Atividades</th>
                    <th>Saldo (€)</th>
                    <th>Progresso</th>
                </tr>
            </thead>
            <tbody>
                <tr data-participant="Andrea">
                    <td>Andréa</td>
                    <td><input type="number" min="0" max="3" value="0" onchange="updateWorkouts(this)"></td>
                    <td><input type="number" min="0" max="3" value="0" onchange="updateWorkouts(this)"></td>
                    <td><input type="number" min="0" max="3" value="0" onchange="updateWorkouts(this)"></td>
                    <td class="total">0</td>
                    <td class="balance">0</td>
                    <td class="progress"></td>
                </tr>
                <tr data-participant="Claudia">
                    <td>Cláudia</td>
                    <td><input type="number" min="0" max="3" value="0" onchange="updateWorkouts(this)"></td>
                    <td><input type="number" min="0" max="3" value="0" onchange="updateWorkouts(this)"></td>
                    <td><input type="number" min="0" max="3" value="0" onchange="updateWorkouts(this)"></td>
                    <td class="total">0</td>
                    <td class="balance">0</td>
                    <td class="progress"></td>
                </tr>
                <tr data-participant="Isabela">
                    <td>Isabela</td>
                    <td><input type="number" min="0" max="3" value="0" onchange="updateWorkouts(this)"></td>
                    <td><input type="number" min="0" max="3" value="0" onchange="updateWorkouts(this)"></td>
                    <td><input type="number" min="0" max="3" value="0" onchange="updateWorkouts(this)"></td>
                    <td class="total">0</td>
                    <td class="balance">0</td>
                    <td class="progress"></td>
                </tr>
                <tr data-participant="Fabiana">
                    <td>Fabiana</td>
                    <td><input type="number" min="0" max="3" value="0" onchange="updateWorkouts(this)"></td>
                    <td><input type="number" min="0" max="3" value="0" onchange="updateWorkouts(this)"></td>
                    <td><input type="number" min="0" max="3" value="0" onchange="updateWorkouts(this)"></td>
                    <td class="total">0</td>
                    <td class="balance">0</td>
                    <td class="progress"></td>
                </tr>
            </tbody>
        </table>

        <div class="info-box">
            <h3>Informações do Desafio:</h3>
            <p>• Período: 06/01/2025 - 31/07/2025</p>
            <p>• Objetivo: 3 atividades por semana</p>
            <p>• Máximo de atividades por semana: 3</p>
            <p>• Multa por atividade não realizada: 10€</p>
            <p id="leaderInfo"></p>
        </div>
    </div>

    <script>
        function updateWorkouts(input) {
            // Limita o valor entre 0 e 3
            input.value = Math.max(0, Math.min(3, parseInt(input.value) || 0));
            
            updateTotalsAndRankings();
        }

        function updateTotalsAndRankings() {
            const rows = document.querySelectorAll('#workoutTable tbody tr');
            let maxTotal = 0;
            let minTotal = Infinity;
            let totals = [];

            // Calcular totais e encontrar máximo/mínimo
            rows.forEach(row => {
                const inputs = row.querySelectorAll('input[type="number"]');
                const total = Array.from(inputs).reduce((sum, input) => sum + (parseInt(input.value) || 0), 0);
                const totalCell = row.querySelector('.total');
                const balanceCell = row.querySelector('.balance');
                const progressCell = row.querySelector('.progress');
                
                totalCell.textContent = total;
                
                // Calcular saldo (10€ por atividade realizada - débito total)
                const totalWeeks = inputs.length;
                const requiredPerWeek = 3;
                const totalRequired = totalWeeks * requiredPerWeek;
                const balance = (total * 10) - (totalRequired * 10);
                balanceCell.textContent = balance + '€';

                // Atualizar barra de progresso
                const maxPossible = totalWeeks * 3;
                const percentage = (total / maxPossible) * 100;
                let progressClass = 'progress-level-1';
                
                if (percentage >= 80) progressClass = 'progress-level-4';
                else if (percentage >= 50) progressClass = 'progress-level-3';
                else if (percentage >= 20) progressClass = 'progress-level-2';

                progressCell.innerHTML = `
                    <div class="progress-bar-container">
                        <div class="progress-bar ${progressClass}" style="width: ${percentage}%">
                            ${Math.round(percentage)}%
                        </div>
                    </div>
                `;

                maxTotal = Math.max(maxTotal, total);
                minTotal = Math.min(minTotal, total);
                totals.push({ name: row.dataset.participant, total });
            });

            // Atualizar classes de liderança
            rows.forEach(row => {
                const total = parseInt(row.querySelector('.total').textContent);
                row.classList.remove('leader', 'last-place');
                if (total === maxTotal && total > 0) row.classList.add('leader');
                if (total === minTotal && total > 0) row.classList.add('last-place');
            });

            // Atualizar informação do líder
            const leaders = totals.filter(t => t.total === maxTotal && t.total > 0);
            const leaderInfo = document.getElementById('leaderInfo');
            if (leaders.length > 0) {
                const leaderText = leaders.length > 1 ? 'Líderes atuais' : 'Líder atual';
                const leaderNames = leaders.map(l => l.name).join(', ');
                leaderInfo.textContent = `• ${leaderText}: ${leaderNames} com ${maxTotal} atividades`;
                leaderInfo.style.color = '#4caf50';
            } else {
                leaderInfo.textContent = '';
            }
        }

        // Inicializar a planilha
        updateTotalsAndRankings();
    </script>
</body>
</html>
